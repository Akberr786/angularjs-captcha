!function(a){"use strict";function b(){var b={},c={captchaEndpoint:""};return{setSettings:function(a){b=a},$get:function(){return a.extend(c,b),c}}}function c(){return function(a){return a.replace(/\/+$/g,"")}}function d(a){return{trim:function(a){return a.replace(/^\s+|\s+$/g,"")},buildUrl:function(a,b){var c=[];for(var d in b)"string"==typeof d&&c.push(d+"="+b[d]);return/\?+/g.test(a)?a+"&"+c.join("&"):a+"?"+c.join("&")},scriptInclude:function(b,c,d){var e=a.document.createElement("script");return e.src=b,e.className=c,e.readyState?e.onreadystatechange=function(){"loaded"!==e.readyState&&"complete"!==e.readyState||"function"==typeof d&&d()}:e.onload=function(){"function"==typeof d&&d()},e},getBaseUrl:function(a){var b="",c=a.match(/id=['"]BDC_BaseUrl['"].*value=['"]([^'"]+)/);return c&&(b=c[1]),b}}}function e(b,c,d,e,f,g){return{restrict:"E",link:function(h,i,j){var k=j.stylename?j.stylename:"defaultCaptcha";c.captchaStyleName=k;var l=e("captchaEndpointFilter")(g.trim(f.captchaEndpoint)),m=b.find("body")[0],n=function(c,d){if(0===b[0].getElementsByClassName("BDC_ScriptInclude").length){var e=g.buildUrl(c+l,{get:"script-include"});a.element(m).append(g.scriptInclude(e,"BDC_ScriptInclude",d))}},o=function(c){var d=b[0].getElementsByClassName("BDC_InitScriptInclude");0!==d.length&&d[0].parentNode.removeChild(d[0]);var e=g.buildUrl(c+l,{get:"init-script-include",c:k,t:i[0].querySelector("#BDC_VCID_"+k).value,cs:"200"});a.element(m).append(g.scriptInclude(e,"BDC_InitScriptInclude"))};d({method:"GET",url:l,params:{get:"html",c:k}}).then(function(a){var b=a.data,d=g.getBaseUrl(b),e=function(){i.html(a.data.replace(/<script.*<\/script>/g,"")),o(d)};if(c.isBDScriptIncludeLoaded)e();else{n(d,function(){e(),c.isBDScriptIncludeLoaded=!0})}},function(a){throw new Error(a.data)})}}}function f(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f,g,h=e;h.$setValidity("incorrectCaptcha",!1),c.bind("blur",function(){(g=c.val())&&(f||(f=new a),f.validate(g).then(function(a){a?h.$setValidity("incorrectCaptcha",!0):(h.$setValidity("incorrectCaptcha",!1),f.reloadImage())}))})}}}function g(a,b){var c=function(){if("undefined"==typeof BotDetect)throw new Error('Can not create Captcha instance, please put "new Captcha()" inside function that will be invoked after form is submitted.');this.captchaStyleName=a.captchaStyleName,this.captchaId=c.getBotDetectInstance().captchaId};return c.getBotDetectInstance=function(){return a.captchaStyleName?BotDetect.getInstanceByStyleName(a.captchaStyleName):null},c.prototype.validate=function(a){return b({method:"GET",url:c.getBotDetectInstance().validationUrl,params:{i:a}}).then(function(a){return a.data},function(a){return a.data})},c.prototype.reloadImage=function(){c.getBotDetectInstance().reloadImage()},c}a.module("BotDetectCaptcha",[]).provider("captchaSettings",b).filter("captchaEndpointFilter",c).factory("captchaHelper",["$window",d]).factory("Captcha",["$rootScope","$http",g]).directive("botdetectCaptcha",["$document","$rootScope","$http","$filter","captchaSettings","captchaHelper",e]).directive("correctCaptcha",["Captcha",f])}(window.angular);
//# sourceMappingURL=angularjs-captcha.min.js.map